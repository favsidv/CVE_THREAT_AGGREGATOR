<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Dashboard CVE</title>
    <link rel="stylesheet" href="{{ url_for('static', filename='styles/index.css') }}">
    <link rel="stylesheet" href="{{ url_for('static', filename='styles/table.css') }}">
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Manrope:wght@200..800&display=swap" rel="stylesheet">
    <link href="https://fonts.googleapis.com/css2?family=Inter:ital,opsz,wght@0,14..32,100..900;1,14..32,100..900&display=swap" rel="stylesheet">
</head>
<body>
    <div id="loading" class="loading">
        <div class="loading_spinner"></div>
    </div>

    <header>
        <div class="header_brand">
            <img src="{{ url_for('static', filename='images/logo.svg') }}" class="header_brandLogo">
            <img src="{{ url_for('static', filename='images/text.svg') }}" class="header_brandText">
        </div>

        <div style="position:absolute;width:100vw;height:200px;border-radius:0px;z-index:98;pointer-events:none;">
            <div style="position:absolute;inset:0;z-index:1;backdrop-filter:blur(0.140625px);-webkit-backdrop-filter:blur(0.140625px);mask-image:linear-gradient(to top, rgba(0, 0, 0, 0) 0%, rgba(0, 0, 0, 1) 12.5%, rgba(0, 0, 0, 1) 25%, rgba(0, 0, 0, 0) 37.5%);-webkit-mask-image:linear-gradient(to top, rgba(0, 0, 0, 0) 0%, rgba(0, 0, 0, 1) 12.5%, rgba(0, 0, 0, 1) 25%, rgba(0, 0, 0, 0) 37.5%);border-radius:0px;pointer-events:none"></div>
            <div style="position:absolute;inset:0;z-index:2;backdrop-filter:blur(0.28125px);-webkit-backdrop-filter:blur(0.28125px);mask-image:linear-gradient(to top, rgba(0, 0, 0, 0) 12.5%, rgba(0, 0, 0, 1) 25%, rgba(0, 0, 0, 1) 37.5%, rgba(0, 0, 0, 0) 50%);-webkit-mask-image:linear-gradient(to top, rgba(0, 0, 0, 0) 12.5%, rgba(0, 0, 0, 1) 25%, rgba(0, 0, 0, 1) 37.5%, rgba(0, 0, 0, 0) 50%);border-radius:0px;pointer-events:none"></div>
            <div style="position:absolute;inset:0;z-index:3;backdrop-filter:blur(0.5625px);-webkit-backdrop-filter:blur(0.5625px);mask-image:linear-gradient(to top, rgba(0, 0, 0, 0) 25%, rgba(0, 0, 0, 1) 37.5%, rgba(0, 0, 0, 1) 50%, rgba(0, 0, 0, 0) 62.5%);-webkit-mask-image:linear-gradient(to top, rgba(0, 0, 0, 0) 25%, rgba(0, 0, 0, 1) 37.5%, rgba(0, 0, 0, 1) 50%, rgba(0, 0, 0, 0) 62.5%);border-radius:0px;pointer-events:none"></div>
            <div style="position:absolute;inset:0;z-index:4;backdrop-filter:blur(1.125px);-webkit-backdrop-filter:blur(1.125px);mask-image:linear-gradient(to top, rgba(0, 0, 0, 0) 37.5%, rgba(0, 0, 0, 1) 50%, rgba(0, 0, 0, 1) 62.5%, rgba(0, 0, 0, 0) 75%);-webkit-mask-image:linear-gradient(to top, rgba(0, 0, 0, 0) 37.5%, rgba(0, 0, 0, 1) 50%, rgba(0, 0, 0, 1) 62.5%, rgba(0, 0, 0, 0) 75%);border-radius:0px;pointer-events:none"></div>
            <div style="position:absolute;inset:0;z-index:5;backdrop-filter:blur(2.25px);-webkit-backdrop-filter:blur(2.25px);mask-image:linear-gradient(to top, rgba(0, 0, 0, 0) 50%, rgba(0, 0, 0, 1) 62.5%, rgba(0, 0, 0, 1) 75%, rgba(0, 0, 0, 0) 87.5%);-webkit-mask-image:linear-gradient(to top, rgba(0, 0, 0, 0) 50%, rgba(0, 0, 0, 1) 62.5%, rgba(0, 0, 0, 1) 75%, rgba(0, 0, 0, 0) 87.5%);border-radius:0px;pointer-events:none"></div>
            <div style="position:absolute;inset:0;z-index:6;backdrop-filter:blur(4.5px);-webkit-backdrop-filter:blur(4.5px);mask-image:linear-gradient(to top, rgba(0, 0, 0, 0) 62.5%, rgba(0, 0, 0, 1) 75%, rgba(0, 0, 0, 1) 87.5%, rgba(0, 0, 0, 0) 100%);-webkit-mask-image:linear-gradient(to top, rgba(0, 0, 0, 0) 62.5%, rgba(0, 0, 0, 1) 75%, rgba(0, 0, 0, 1) 87.5%, rgba(0, 0, 0, 0) 100%);border-radius:0px;pointer-events:none"></div>
            <div style="position:absolute;inset:0;z-index:7;backdrop-filter:blur(9px);-webkit-backdrop-filter:blur(9px);mask-image:linear-gradient(to top, rgba(0, 0, 0, 0) 75%, rgba(0, 0, 0, 1) 87.5%, rgba(0, 0, 0, 1) 100%);-webkit-mask-image:linear-gradient(to top, rgba(0, 0, 0, 0) 75%, rgba(0, 0, 0, 1) 87.5%, rgba(0, 0, 0, 1) 100%);border-radius:0px;pointer-events:none"></div>
            <div style="position:absolute;inset:0;z-index:8;backdrop-filter:blur(18px);-webkit-backdrop-filter:blur(18px);mask-image:linear-gradient(to top, rgba(0, 0, 0, 0) 87.5%, rgba(0, 0, 0, 1) 100%);-webkit-mask-image:linear-gradient(to top, rgba(0, 0, 0, 0) 87.5%, rgba(0, 0, 0, 1) 100%);border-radius:0px;pointer-events:none"></div>
        </div>
    </header>

    <div id="overallBody">
        <div class="container">
            <img src="{{ url_for('static', filename='icons/filter.svg') }}" class="table_searchContainerIcon">
            <input type="text" id="table_searchContainerInput" class="table_searchContainerInput" placeholder="Recherche">

            <table class="table_frame">
                <thead>
                    <tr class="table_frameTrException">
                        <th data-sort="cve" class="table_frameCve">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CVE <span class="sort-icon"></span></th>
                        <th data-sort="type" class="table_frameType">Type <span class="sort-icon"></span></th>
                        <th data-sort="title"  class="table_frameTitle">Titre <span class="sort-icon"></span></th>
                        <th data-sort="date" class="table_frameDate">Date <span class="sort-icon"></span></th>
                        <th data-sort="cvss" class="table_frameScoreCVSS">Score CVSS <span class="sort-icon"></span></th>
                    </tr>
                </thead>
                <tbody id="table_frameBody"></tbody>
            </table>

            <div class="table_pagination">
                <div class="table_paginationRowSelector">
                    <span>CVE par page</span>
                    <div class="table_paginationRowSelectorWrapper">
                        <select id="table_paginationRowSelectorWrapperSelect" class="table_paginationRowSelectorWrapperSelect">
                            <option value="10">10</option>
                            <option value="20">20</option>
                            <option value="30">30</option>
                            <option value="50">50</option>
                        </select>
                    </div>
                </div>
                
                <div class="table_paginationControls">
                    <p>
                        <span id="table_paginationControlsRangeL" class="table_paginationControlsRange">0-0</span>
                         sur 
                        <span id="table_paginationControlsRangeR" class="table_paginationControlsRange">0</span>
                    </p>
                    <button id="table_paginationControlsBtnFirstPage" class="table_paginationControlsBtn" aria-label="First page">
                        <svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-chevron-first" aria-hidden="true"><path d="m17 18-6-6 6-6"></path><path d="M7 6v12"></path></svg>
                    </button>
                    <button id="table_paginationControlsBtnPrevPage" class="table_paginationControlsBtn" aria-label="Previous page">
                        <svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-chevron-left" aria-hidden="true"><path d="m15 18-6-6 6-6"></path></svg>
                    </button>
                    <button id="table_paginationControlsBtnNextPage" class="table_paginationControlsBtn" aria-label="Next page">
                        <svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-chevron-right" aria-hidden="true"><path d="m9 18 6-6-6-6"></path></svg>
                    </button>
                    <button id="table_paginationControlsBtnNextPageLastPage" class="table_paginationControlsBtn" aria-label="Last page">
                        <svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-chevron-last" aria-hidden="true"><path d="m7 18 6-6-6-6"></path><path d="M17 6v12"></path></svg>
                    </button>
                </div>
            </div>

            <p class="title">GRAPHIQUES</p>

            <div id="cvssHistogram" class="chart_wrapper"></div>

            <div id="cwePieChart" class="chart_wrapper"></div>

            <div id="epssLineChart" class="chart_wrapper"></div>
            
            <div style="margin-top: 40px;" class="chart-container">
                <h2 style="margin-bottom: 20px; color: white; font-size: 1.5rem; font-weight: bold;">Distribution par Éditeur/Produit</h2>
                <div id="vendorProductChart"></div>
            </div>
            
            <div style="margin-top: 40px;" class="chart-container">
                <h2 style="margin-bottom: 20px; color: white; font-size: 1.5rem; font-weight: bold;">CVSS vs EPSS</h2>
                <div id="scatterPlot"></div>
            </div>

            <div style="margin-top: 40px;" class="chart-container">
                <h2 style="margin-bottom: 20px; color: white; font-size: 1.5rem; font-weight: bold;">Corrélation CVSS/EPSS</h2>
                <div style="margin-top: 450px;" id="correlationHeatmap"></div>
            </div>

            <div style="margin-top: 40px;" class="chart-container">
                <h2 style="margin-bottom: 20px; color: white; font-size: 1.5rem; font-weight: bold;">Évolution Cumulative des Vulnérabilités</h2>
                <div id="cumulativeChart"></div>
            </div>

            <div style="margin-top: 40px;" class="chart-container">
                <h2 style="margin-bottom: 20px; color: white; font-size: 1.5rem; font-weight: bold;">Distribution des Scores CVSS par Éditeur</h2>
                <div id="cvssBoxPlot"></div>
            </div>

            <div style="margin-top: 40px;" class="chart-container">
                <h2 style="margin-bottom: 20px; color: white; font-size: 1.5rem; font-weight: bold;">Analyse détaillée par Type CWE</h2>
                <div id="cweDetails"></div>
            </div>

            <div style="margin-top: 40px;" class="chart-container">
                <h2 style="margin-bottom: 20px; color: white; font-size: 1.5rem; font-weight: bold;">Analyse des Versions Affectées</h2>
                <div id="versionAnalysis"></div>
            </div>

            <div id="detailModal" class="modal">
                <div class="modal-content">
                    <div class="modal-header">
                        <h2 class="modal-title">Détails de la vulnérabilité</h2>
                        <button id="modalCloseBtn" class="modal-close">&times;</button>
                    </div>
                    <div id="modalBody" class="modal-body"></div>
                </div>
            </div>
        </div>
    </div>

    <script src="{{ url_for('static', filename='js/index.js') }}"></script>
    <script src="https://unpkg.com/react@18/umd/react.development.min.js" crossorigin></script>
    <script src="https://unpkg.com/react-dom@18/umd/react-dom.development.min.js" crossorigin></script>
    <script src="https://unpkg.com/recharts/umd/Recharts.js" crossorigin></script>
    <script src="{{ url_for('static', filename='dist/bundle.js') }}"></script>
</body>
</html>